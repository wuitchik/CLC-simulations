legend.position = c(0.95, 0.05),
legend.justification = c(1, 0),
legend.background = element_rect(fill = alpha('white', 0.6), color = "black"),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6),
legend.key.size = unit(0.3, "cm"),
legend.title.align = 0.5
)
# Plot for adults
max_adults <- max(c(df$avg_predLagAdults, df$avg_obsLagAdults), na.rm = TRUE)
ggplot(df, aes(x = avg_predLagAdults, y = avg_obsLagAdults, fill = eta)) +
geom_point(alpha = 0.9, shape = 21, color = "black", size = 3, stroke = 0.3) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
coord_equal(xlim = c(0, max_adults), ylim = c(0, max_adults)) +
theme_bw() +
labs(x = "Predicted Adult Lag", y = "Observed Adult Lag", fill = "η") +
scale_fill_viridis(option = "viridis", direction = -1) +
theme(
legend.position = c(0.95, 0.05),
legend.justification = c(1, 0),
legend.background = element_rect(fill = alpha('white', 0.6), color = "black"),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6),
legend.key.size = unit(0.3, "cm"),
legend.title.align = 0.5
)
library(tidyverse)
library(viridis)
library(patchwork)
install.packages("patchwork")
library(tidyverse)
library(viridis)
library(patchwork)
# Load and clean data
df <- read_csv("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/processed/eta_ground_NOseason_summary.csv") %>%
filter(if_all(everything(), is.finite)) %>%
filter(!if_any(everything(), ~ . < 0)) %>%
filter(eta < 0.35) %>%
na.omit()
# Plot for larvae
max_larvae <- max(c(df$avg_predLagLarvae, df$avg_obsLagLarvae), na.rm = TRUE)
p1 <- ggplot(df, aes(x = avg_predLagLarvae, y = avg_obsLagLarvae, fill = eta)) +
geom_point(alpha = 0.9, shape = 21, color = "black", size = 3, stroke = 0.3) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
coord_equal(xlim = c(0, max_larvae), ylim = c(0, max_larvae)) +
theme_bw() +
labs(x = "Predicted Larval Lag", y = "Observed Larval Lag", fill = "η") +
scale_fill_viridis(option = "viridis", direction = -1) +
theme(
legend.position = c(0.95, 0.05),
legend.justification = c(1, 0),
legend.background = element_rect(fill = alpha('white', 0.6), color = "black"),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6),
legend.key.size = unit(0.3, "cm"),
legend.title.align = 0.5
)
# Plot for adults
max_adults <- max(c(df$avg_predLagAdults, df$avg_obsLagAdults), na.rm = TRUE)
p2 <- ggplot(df, aes(x = avg_predLagAdults, y = avg_obsLagAdults, fill = eta)) +
geom_point(alpha = 0.9, shape = 21, color = "black", size = 3, stroke = 0.3) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
coord_equal(xlim = c(0, max_adults), ylim = c(0, max_adults)) +
theme_bw() +
labs(x = "Predicted Adult Lag", y = "Observed Adult Lag", fill = "η") +
scale_fill_viridis(option = "viridis", direction = -1) +
theme(
legend.position = c(0.95, 0.05),
legend.justification = c(1, 0),
legend.background = element_rect(fill = alpha('white', 0.6), color = "black"),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6),
legend.key.size = unit(0.3, "cm"),
legend.title.align = 0.5
)
# Combine with patchwork and add labels A) and B)
combined_plot <- p1 + p2 + plot_annotation(tag_levels = "A")
# Show or save
print(combined_plot)
ggsave("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/figs/ground_truth/no_season_pred_vs_obser.png", combined_plot, width = 10, height = 5)
ggsave("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/figs/ground_truth/no_season_pred_vs_obser.pdf", combined_plot, width = 10, height = 5)
library(tidyverse)
# List all lag_*.csv files
files <- list.files(
path = "/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/raw/eta_marshall_comp",
pattern = "^lag_[0-9]+\\.csv$",
full.names = TRUE
)
# Function to read and summarize each file
summarize_lag <- function(file) {
seed <- as.numeric(str_extract(file, "\\d+"))
eta <- seed * 0.01
df <- read.delim(file, sep = "\t", header = TRUE) %>%
filter(tick > 1100) # %>%
#filter(if_all(starts_with("obsLag"), is.finite),
#      if_all(starts_with("predLag"), is.finite))
#if (nrow(df) == 0) return(NULL)  # Skip empty summaries
tibble(
eta = eta,
avg_obsLagLarvae = mean(df$obsLagLarvae, na.rm = TRUE),
avg_predLagLarvae = mean(df$predLagLarvae, na.rm = TRUE),
avg_obsLagAdults = mean(df$obsLagAdults, na.rm = TRUE),
avg_predLagAdults = mean(df$predLagAdults, na.rm = TRUE)
)
}
# Apply the function to all files and combine
summary_df <- map_dfr(files, summarize_lag)
# Save to CSV
write_csv(summary_df, "/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/processed/eta_ground_NOseason_summary.csv")
# Print first few lines to confirm
print(head(summary_df))
library(tidyverse)
library(viridis)
library(patchwork)
# Load and clean data
df <- read_csv("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/processed/eta_ground_NOseason_summary.csv") %>%
filter(if_all(everything(), is.finite)) %>%
filter(!if_any(everything(), ~ . < 0)) %>%
filter(eta < 0.35) %>%
na.omit()
# Plot for larvae
max_larvae <- max(c(df$avg_predLagLarvae, df$avg_obsLagLarvae), na.rm = TRUE)
p1 <- ggplot(df, aes(x = avg_predLagLarvae, y = avg_obsLagLarvae, fill = eta)) +
geom_point(alpha = 0.9, shape = 21, color = "black", size = 3, stroke = 0.3) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
coord_equal(xlim = c(0, max_larvae), ylim = c(0, max_larvae)) +
theme_bw() +
labs(x = "Predicted Larval Lag", y = "Observed Larval Lag", fill = "η") +
scale_fill_viridis(option = "viridis", direction = -1) +
theme(
legend.position = c(0.95, 0.05),
legend.justification = c(1, 0),
legend.background = element_rect(fill = alpha('white', 0.6), color = "black"),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6),
legend.key.size = unit(0.3, "cm"),
legend.title.align = 0.5
)
# Plot for adults
max_adults <- max(c(df$avg_predLagAdults, df$avg_obsLagAdults), na.rm = TRUE)
p2 <- ggplot(df, aes(x = avg_predLagAdults, y = avg_obsLagAdults, fill = eta)) +
geom_point(alpha = 0.9, shape = 21, color = "black", size = 3, stroke = 0.3) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
coord_equal(xlim = c(0, max_adults), ylim = c(0, max_adults)) +
theme_bw() +
labs(x = "Predicted Adult Lag", y = "Observed Adult Lag", fill = "η") +
scale_fill_viridis(option = "viridis", direction = -1) +
theme(
legend.position = c(0.95, 0.05),
legend.justification = c(1, 0),
legend.background = element_rect(fill = alpha('white', 0.6), color = "black"),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6),
legend.key.size = unit(0.3, "cm"),
legend.title.align = 0.5
)
# Combine with patchwork and add labels A) and B)
combined_plot <- p1 + p2 + plot_annotation(tag_levels = "A")
ggsave("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/figs/ground_truth/no_season_pred_vs_obser.png", combined_plot, width = 10, height = 5)
ggsave("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/figs/ground_truth/no_season_pred_vs_obser.pdf", combined_plot, width = 10, height = 5)
# List all lag_*.csv files
files <- list.files(
path = "/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/raw/eta_marshall_comp",
pattern = "^lag_[0-9]+\\.csv$",
full.names = TRUE
)
# Function to read and summarize each file
summarize_lag <- function(file) {
seed <- as.numeric(str_extract(file, "\\d+"))
eta <- seed * 0.01
df <- read.delim(file, sep = "\t", header = TRUE) %>%
filter(tick > 1100) # %>%
#filter(if_all(starts_with("obsLag"), is.finite),
#      if_all(starts_with("predLag"), is.finite))
#if (nrow(df) == 0) return(NULL)  # Skip empty summaries
tibble(
eta = eta,
avg_obsLagLarvae = mean(df$obsLagLarvae, na.rm = TRUE),
avg_predLagLarvae = mean(df$predLagLarvae, na.rm = TRUE),
avg_obsLagAdults = mean(df$obsLagAdults, na.rm = TRUE),
avg_predLagAdults = mean(df$predLagAdults, na.rm = TRUE)
)
}
# Apply the function to all files and combine
summary_df <- map_dfr(files, summarize_lag)
# Save to CSV
write_csv(summary_df, "/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/processed/eta_ground_NOseason_summary.csv")
# Print first few lines to confirm
print(head(summary_df))
library(tidyverse)
library(viridis)
library(patchwork)
# Load and clean data
df <- read_csv("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/processed/eta_ground_NOseason_summary.csv") %>%
filter(if_all(everything(), is.finite)) %>%
filter(!if_any(everything(), ~ . < 0)) %>%
filter(eta < 0.35) %>%
na.omit()
# Plot for larvae
max_larvae <- max(c(df$avg_predLagLarvae, df$avg_obsLagLarvae), na.rm = TRUE)
p1 <- ggplot(df, aes(x = avg_predLagLarvae, y = avg_obsLagLarvae, fill = eta)) +
geom_point(alpha = 0.9, shape = 21, color = "black", size = 3, stroke = 0.3) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
coord_equal(xlim = c(0, max_larvae), ylim = c(0, max_larvae)) +
theme_bw() +
labs(x = "Predicted Larval Lag", y = "Observed Larval Lag", fill = "η") +
scale_fill_viridis(option = "viridis", direction = -1) +
theme(
legend.position = c(0.95, 0.05),
legend.justification = c(1, 0),
legend.background = element_rect(fill = alpha('white', 0.6), color = "black"),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6),
legend.key.size = unit(0.3, "cm"),
legend.title.align = 0.5
)
# Plot for adults
max_adults <- max(c(df$avg_predLagAdults, df$avg_obsLagAdults), na.rm = TRUE)
p2 <- ggplot(df, aes(x = avg_predLagAdults, y = avg_obsLagAdults, fill = eta)) +
geom_point(alpha = 0.9, shape = 21, color = "black", size = 3, stroke = 0.3) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
coord_equal(xlim = c(0, max_adults), ylim = c(0, max_adults)) +
theme_bw() +
labs(x = "Predicted Adult Lag", y = "Observed Adult Lag", fill = "η") +
scale_fill_viridis(option = "viridis", direction = -1) +
theme(
legend.position = c(0.95, 0.05),
legend.justification = c(1, 0),
legend.background = element_rect(fill = alpha('white', 0.6), color = "black"),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6),
legend.key.size = unit(0.3, "cm"),
legend.title.align = 0.5
)
# Combine with patchwork and add labels A) and B)
combined_plot <- p1 + p2 + plot_annotation(tag_levels = "A")
ggsave("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/figs/ground_truth/no_season_pred_vs_obser.png", combined_plot, width = 10, height = 5)
ggsave("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/figs/ground_truth/no_season_pred_vs_obser.pdf", combined_plot, width = 10, height = 5)
library(tidyverse)
# List all lag_*.csv files
files <- list.files(
path = "/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/raw/eta_marshall_comp_seasons/",
pattern = "^lag_[0-9]+\\.csv$",
full.names = TRUE
)
# Function to read and summarize each file
summarize_lag <- function(file) {
seed <- as.numeric(str_extract(file, "\\d+"))
eta <- seed * 0.01
df <- read.delim(file, sep = "\t", header = TRUE) %>%
filter(tick > 1100) # %>%
#filter(if_all(starts_with("obsLag"), is.finite),
#      if_all(starts_with("predLag"), is.finite))
#if (nrow(df) == 0) return(NULL)  # Skip empty summaries
tibble(
eta = eta,
avg_obsLagLarvae = mean(df$obsLagLarvae, na.rm = TRUE),
avg_predLagLarvae = mean(df$predLagLarvae, na.rm = TRUE),
avg_obsLagAdults = mean(df$obsLagAdults, na.rm = TRUE),
avg_predLagAdults = mean(df$predLagAdults, na.rm = TRUE)
)
}
# Apply the function to all files and combine
summary_df <- map_dfr(files, summarize_lag)
# Save to CSV
write_csv(summary_df, "/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/processed/eta_ground_YESseason_summary.csv")
# Print first few lines to confirm
print(head(summary_df))
# Load and clean data
df <- read_csv("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/processed/eta_ground_YESseason_summary.csv") %>%
filter(if_all(everything(), is.finite)) %>%
filter(!if_any(everything(), ~ . < 0)) %>%
filter(eta < 0.35) %>%
na.omit()
# Plot for larvae
max_larvae <- max(c(df$avg_predLagLarvae, df$avg_obsLagLarvae), na.rm = TRUE)
p1 <- ggplot(df, aes(x = avg_predLagLarvae, y = avg_obsLagLarvae, fill = eta)) +
geom_point(alpha = 0.9, shape = 21, color = "black", size = 3, stroke = 0.3) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
coord_equal(xlim = c(0, max_larvae), ylim = c(0, max_larvae)) +
theme_bw() +
labs(x = "Predicted Larval Lag", y = "Observed Larval Lag", fill = "η") +
scale_fill_viridis(option = "viridis", direction = -1) +
theme(
legend.position = c(0.95, 0.05),
legend.justification = c(1, 0),
legend.background = element_rect(fill = alpha('white', 0.6), color = "black"),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6),
legend.key.size = unit(0.3, "cm"),
legend.title.align = 0.5
)
# Plot for adults
max_adults <- max(c(df$avg_predLagAdults, df$avg_obsLagAdults), na.rm = TRUE)
p2 <- ggplot(df, aes(x = avg_predLagAdults, y = avg_obsLagAdults, fill = eta)) +
geom_point(alpha = 0.9, shape = 21, color = "black", size = 3, stroke = 0.3) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
coord_equal(xlim = c(0, max_adults), ylim = c(0, max_adults)) +
theme_bw() +
labs(x = "Predicted Adult Lag", y = "Observed Adult Lag", fill = "η") +
scale_fill_viridis(option = "viridis", direction = -1) +
theme(
legend.position = c(0.95, 0.05),
legend.justification = c(1, 0),
legend.background = element_rect(fill = alpha('white', 0.6), color = "black"),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6),
legend.key.size = unit(0.3, "cm"),
legend.title.align = 0.5
)
# Combine with patchwork and add labels A) and B)
combined_plot <- p1 + p2 + plot_annotation(tag_levels = "A")
combined_plot
ggsave("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/figs/ground_truth/season_pred_vs_obser.png", combined_plot, width = 10, height = 5)
ggsave("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/figs/ground_truth/season_pred_vs_obser.pdf", combined_plot, width = 10, height = 5)
# Load and clean data
df <- read_csv("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/processed/eta_ground_YESseason_summary.csv") %>%
filter(if_all(everything(), is.finite)) %>%
filter(!if_any(everything(), ~ . < 0)) %>%
filter(eta < 0.34) %>%
na.omit()
# Plot for larvae
max_larvae <- max(c(df$avg_predLagLarvae, df$avg_obsLagLarvae), na.rm = TRUE)
p1 <- ggplot(df, aes(x = avg_predLagLarvae, y = avg_obsLagLarvae, fill = eta)) +
geom_point(alpha = 0.9, shape = 21, color = "black", size = 3, stroke = 0.3) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
coord_equal(xlim = c(0, max_larvae), ylim = c(0, max_larvae)) +
theme_bw() +
labs(x = "Predicted Larval Lag", y = "Observed Larval Lag", fill = "η") +
scale_fill_viridis(option = "viridis", direction = -1) +
theme(
legend.position = c(0.95, 0.05),
legend.justification = c(1, 0),
legend.background = element_rect(fill = alpha('white', 0.6), color = "black"),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6),
legend.key.size = unit(0.3, "cm"),
legend.title.align = 0.5
)
# Plot for adults
max_adults <- max(c(df$avg_predLagAdults, df$avg_obsLagAdults), na.rm = TRUE)
p2 <- ggplot(df, aes(x = avg_predLagAdults, y = avg_obsLagAdults, fill = eta)) +
geom_point(alpha = 0.9, shape = 21, color = "black", size = 3, stroke = 0.3) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
coord_equal(xlim = c(0, max_adults), ylim = c(0, max_adults)) +
theme_bw() +
labs(x = "Predicted Adult Lag", y = "Observed Adult Lag", fill = "η") +
scale_fill_viridis(option = "viridis", direction = -1) +
theme(
legend.position = c(0.95, 0.05),
legend.justification = c(1, 0),
legend.background = element_rect(fill = alpha('white', 0.6), color = "black"),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6),
legend.key.size = unit(0.3, "cm"),
legend.title.align = 0.5
)
# Combine with patchwork and add labels A) and B)
combined_plot <- p1 + p2 + plot_annotation(tag_levels = "A")
combined_plot
# Load and clean data
df <- read_csv("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/processed/eta_ground_YESseason_summary.csv") %>%
filter(if_all(everything(), is.finite)) %>%
filter(!if_any(everything(), ~ . < 0)) %>%
filter(eta < 0.32) %>%
na.omit()
# Plot for larvae
max_larvae <- max(c(df$avg_predLagLarvae, df$avg_obsLagLarvae), na.rm = TRUE)
p1 <- ggplot(df, aes(x = avg_predLagLarvae, y = avg_obsLagLarvae, fill = eta)) +
geom_point(alpha = 0.9, shape = 21, color = "black", size = 3, stroke = 0.3) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
coord_equal(xlim = c(0, max_larvae), ylim = c(0, max_larvae)) +
theme_bw() +
labs(x = "Predicted Larval Lag", y = "Observed Larval Lag", fill = "η") +
scale_fill_viridis(option = "viridis", direction = -1) +
theme(
legend.position = c(0.95, 0.05),
legend.justification = c(1, 0),
legend.background = element_rect(fill = alpha('white', 0.6), color = "black"),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6),
legend.key.size = unit(0.3, "cm"),
legend.title.align = 0.5
)
# Plot for adults
max_adults <- max(c(df$avg_predLagAdults, df$avg_obsLagAdults), na.rm = TRUE)
p2 <- ggplot(df, aes(x = avg_predLagAdults, y = avg_obsLagAdults, fill = eta)) +
geom_point(alpha = 0.9, shape = 21, color = "black", size = 3, stroke = 0.3) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
coord_equal(xlim = c(0, max_adults), ylim = c(0, max_adults)) +
theme_bw() +
labs(x = "Predicted Adult Lag", y = "Observed Adult Lag", fill = "η") +
scale_fill_viridis(option = "viridis", direction = -1) +
theme(
legend.position = c(0.95, 0.05),
legend.justification = c(1, 0),
legend.background = element_rect(fill = alpha('white', 0.6), color = "black"),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6),
legend.key.size = unit(0.3, "cm"),
legend.title.align = 0.5
)
# Combine with patchwork and add labels A) and B)
combined_plot <- p1 + p2 + plot_annotation(tag_levels = "A")
combined_plot
ggsave("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/figs/ground_truth/season_pred_vs_obser.png", combined_plot, width = 10, height = 5)
ggsave("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/figs/ground_truth/season_pred_vs_obser.pdf", combined_plot, width = 10, height = 5)
# List all lag_*.csv files
files <- list.files(
path = "/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/raw/eta_marshall_comp_seasons_negCOV/",
pattern = "^lag_[0-9]+\\.csv$",
full.names = TRUE
)
# Function to read and summarize each file
summarize_lag <- function(file) {
seed <- as.numeric(str_extract(file, "\\d+"))
eta <- seed * 0.01
df <- read.delim(file, sep = "\t", header = TRUE) %>%
filter(tick > 1100) # %>%
#filter(if_all(starts_with("obsLag"), is.finite),
#      if_all(starts_with("predLag"), is.finite))
#if (nrow(df) == 0) return(NULL)  # Skip empty summaries
tibble(
eta = eta,
avg_obsLagLarvae = mean(df$obsLagLarvae, na.rm = TRUE),
avg_predLagLarvae = mean(df$predLagLarvae, na.rm = TRUE),
avg_obsLagAdults = mean(df$obsLagAdults, na.rm = TRUE),
avg_predLagAdults = mean(df$predLagAdults, na.rm = TRUE)
)
}
# Apply the function to all files and combine
summary_df <- map_dfr(files, summarize_lag)
# Save to CSV
write_csv(summary_df, "/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/processed/eta_ground_YESseason_summary_negCOV.csv")
# Apply the function to all files and combine
summary_df <- map_dfr(files, summarize_lag)
# List all lag_*.csv files
files <- list.files(
path = "/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/raw/eta_marshall_comp_seasons_negCOV/",
pattern = "^lag_[0-9]+\\.csv$",
full.names = TRUE
)
# Function to read and summarize each file
summarize_lag <- function(file) {
seed <- as.numeric(str_extract(file, "\\d+"))
eta <- seed * 0.01
df <- read.delim(file, sep = "\t", header = TRUE) %>%
filter(tick > 1100) # %>%
#filter(if_all(starts_with("obsLag"), is.finite),
#      if_all(starts_with("predLag"), is.finite))
#if (nrow(df) == 0) return(NULL)  # Skip empty summaries
tibble(
eta = eta,
avg_obsLagLarvae = mean(df$obsLagLarvae, na.rm = TRUE),
avg_predLagLarvae = mean(df$predLagLarvae, na.rm = TRUE),
avg_obsLagAdults = mean(df$obsLagAdults, na.rm = TRUE),
avg_predLagAdults = mean(df$predLagAdults, na.rm = TRUE)
)
}
# Apply the function to all files and combine
summary_df <- map_dfr(files, summarize_lag)
# Save to CSV
write_csv(summary_df, "/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/processed/eta_ground_YESseason_summary_negCOV.csv")
# Print first few lines to confirm
print(head(summary_df))
# Load and clean data
df <- read_csv("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/data/processed/eta_ground_YESseason_summary_negCOV.csv") %>%
filter(if_all(everything(), is.finite)) %>%
filter(!if_any(everything(), ~ . < 0)) %>%
filter(eta < 0.32) %>%
na.omit()
# Plot for larvae
max_larvae <- max(c(df$avg_predLagLarvae, df$avg_obsLagLarvae), na.rm = TRUE)
p1 <- ggplot(df, aes(x = avg_predLagLarvae, y = avg_obsLagLarvae, fill = eta)) +
geom_point(alpha = 0.9, shape = 21, color = "black", size = 3, stroke = 0.3) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
coord_equal(xlim = c(0, max_larvae), ylim = c(0, max_larvae)) +
theme_bw() +
labs(x = "Predicted Larval Lag", y = "Observed Larval Lag", fill = "η") +
scale_fill_viridis(option = "viridis", direction = -1) +
theme(
legend.position = c(0.95, 0.05),
legend.justification = c(1, 0),
legend.background = element_rect(fill = alpha('white', 0.6), color = "black"),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6),
legend.key.size = unit(0.3, "cm"),
legend.title.align = 0.5
)
# Plot for adults
max_adults <- max(c(df$avg_predLagAdults, df$avg_obsLagAdults), na.rm = TRUE)
p2 <- ggplot(df, aes(x = avg_predLagAdults, y = avg_obsLagAdults, fill = eta)) +
geom_point(alpha = 0.9, shape = 21, color = "black", size = 3, stroke = 0.3) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
coord_equal(xlim = c(0, max_adults), ylim = c(0, max_adults)) +
theme_bw() +
labs(x = "Predicted Adult Lag", y = "Observed Adult Lag", fill = "η") +
scale_fill_viridis(option = "viridis", direction = -1) +
theme(
legend.position = c(0.95, 0.05),
legend.justification = c(1, 0),
legend.background = element_rect(fill = alpha('white', 0.6), color = "black"),
legend.title = element_text(size = 8),
legend.text = element_text(size = 6),
legend.key.size = unit(0.3, "cm"),
legend.title.align = 0.5
)
# Combine with patchwork and add labels A) and B)
combined_plot <- p1 + p2 + plot_annotation(tag_levels = "A")
combined_plot
ggsave("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/figs/ground_truth/season_negCOV_pred_vs_obser.png", combined_plot, width = 10, height = 5)
ggsave("/Users/danielwuitchik/Documents/Experiments/Crepidula_tufts/Github/CLC-simulations/figs/ground_truth/season_negCOV_pred_vs_obser.pdf", combined_plot, width = 10, height = 5)
